---
title: Azure AD Provisioning to applications via PowerShell
description: This document describes how to configure Azure AD to provision users with external systems that offer Windows PowerShell based APIs.
services: active-directory
author: billmath
manager: amycolannino
ms.service: active-directory
ms.subservice: app-provisioning
ms.topic: how-to
ms.workload: identity
ms.date: 02/08/2022
ms.author: billmath
ms.reviewer: arvinh
---

# Provisioning users into applications using PowerShell
The following documentation provides configuration and tutorial information demonstrating how the generic PowerShell connector and the ECMA Connector Host can be used to integrate Azure AD with external systems that offer Windows PowerShell based APIs.

For additional information see [Windows PowerShell Connector technical reference](/microsoft-identity-manager/reference/microsoft-identity-manager-2016-connector-powershell)


## Prerequisites for provisioning via PowerShell

### On-premises prerequisites

The connector provides a bridge between the capabilities of the ECMA Connector Host and Windows PowerShell. Before you use the Connector, make sure you have the following on the server hosting the connector



- A Windows Server 2016 or a later version. 
- At least 3 GB of RAM, to host a provisioning agent. 
- .NET Framework 4.7.2 
- Windows PowerShell 2.0, 3.0, or 4.0
-  Connectivity to the target system hosting the PowerShell API.
- The execution policy on the server must be configured to allow the connector to run Windows PowerShell scripts. Unless the scripts the connector runs are digitally signed, configure the execution policy by running this command:  
`Set-ExecutionPolicy -ExecutionPolicy RemoteSigned`
- Deploying this connector will require one or more PowerShell scripts.  Some Microsoft products may provide scripts for use with this connector, and the support statement for those scripts would be provided by that product.  If you are developing your own scripts for use with this connector, you will need to have familiarity with the [Extensible Connectivity Management Agent API](https://msdn.microsoft.com/library/windows/desktop/hh859557.aspx) to develop and maintain those scripts.  If you are integrating with third party systems using your own scripts in a production environment, we recommend you work with the third party vendor or a deployment partner for help, guidance and support for this integration.



### Cloud requirements

 - An Azure AD tenant with Azure AD Premium P1 or Premium P2 (or EMS E3 or E5).   [!INCLUDE [active-directory-p1-license.md](../../../includes/active-directory-p1-license.md)]
 - The Hybrid Identity Administrator role for configuring the provisioning agent and the Application Administrator or Cloud Application Administrator roles for configuring provisioning in the Azure portal.
 - The Azure AD users to be provisioned to the database must already be populated with any attributes that will be required by the database schema and that are not generated by the database itself.


## Appendix A - InputFile.txt

## Appendix B - xADSyncPSConnectorModule.psm1 

## Apendix C - Schema.xml 

## Appendix D - Import Script

## Appendix E - Export Script
